(()=>{var e=function(){var e="";function t(t){e=t}function n(){return e}function a(){var e=document.querySelector('meta[name="subscription-key"]');return e?e.getAttribute("content"):""}return{createChatBotUI:function(){var e=document.createElement("div");e.classList.add("chatbot-container");var i=document.createElement("div");i.classList.add("chatbot-icon"),e.appendChild(i);var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("viewBox","0 0 44 39"),s.setAttribute("width","44px"),s.setAttribute("height","39px"),s.innerHTML='<path fill-rule="evenodd" clip-rule="evenodd" d="M32.5823 0C38.5557 0 43.443 4.83789 43.443 10.7509V22.8456C43.443 28.7586 38.5557 33.5964 32.5823 33.5964H12.6256C11.4038 33.5964 10.3177 33.9996 9.36741 34.6715L4.3443 38.4343C3.12247 39.375 1.49335 39.1063 0.543038 37.8968C0.135759 37.4936 0 36.8217 0 36.2842V10.7509C0 4.83789 4.88734 0 10.8608 0H32.5823Z" fill="#DA291C"></path><g clip-path="url(#clip0_8292_1209)"><path d="M24.7795 9.87305L31.5917 24.6832H29.713L22.8477 9.87305H24.7795Z" fill="white"></path><path d="M21.0881 9.87305L27.9003 24.6832H26.0208L19.1562 9.87305H21.0881Z" fill="white"></path><path d="M19.1528 9.87305L12.3398 24.6832H14.2193L21.0839 9.87305H19.1528Z" fill="white"></path></g><defs><clipPath id="clip0_8292_1209"><rect width="19.2532" height="14.8101" fill="white" transform="translate(12.3398 9.87305)"></rect></clipPath></defs>',i.appendChild(s);var d=document.createElement("div");d.classList.add("auth-modal"),d.style.display="none";var l=document.createElement("h2");l.textContent="Welcome",d.appendChild(l);var o=document.createElement("input");o.classList.add("auth-input"),o.setAttribute("type","text"),o.setAttribute("placeholder","Enter subscription key to start"),d.appendChild(o);var r=document.createElement("div");r.classList.add("error-message"),d.appendChild(r);var c=document.createElement("button");c.classList.add("auth-button"),c.textContent="Submit",d.appendChild(c);var p=document.createElement("div");p.classList.add("chatbot-modal"),p.style.display="none";var h=document.createElement("div");h.classList.add("header");var u=document.createElement("div");u.classList.add("head-logo");var m=document.createElement("h3");m.classList.add("head-text"),m.textContent="Arist Assistant",u.append(m);var v=document.createElement("div");v.classList.add("svg-container");var f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttribute("xmlns","http://www.w3.org/2000/svg"),f.setAttribute("width","35"),f.setAttribute("height","31"),f.setAttribute("viewBox","0 0 35 31"),f.setAttribute("fill","none"),f.innerHTML='\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M26.1297 0.0117188C30.8761 0.0117188 34.7595 3.85581 34.7595 8.55414V18.1644C34.7595 22.8627 30.8761 26.7068 26.1297 26.7068H10.2726C9.30171 26.7068 8.43874 27.0271 7.68364 27.561L3.69238 30.5509C2.72153 31.2983 1.42707 31.0848 0.671966 30.1238C0.34835 29.8034 0.240479 29.2695 0.240479 28.8424V8.55414C0.240479 3.85581 4.12386 0.0117188 8.87022 0.0117188H26.1297Z" fill="white"/>\n        <g clip-path="url(#clip0_9590_870)">\n            <path d="M19.9312 7.85645L25.3441 19.6243H23.8513L18.3962 7.85645H19.9312Z" fill="#DA291C"/>\n            <path d="M16.9957 7.85645L22.4085 19.6243H20.9151L15.4607 7.85645H16.9957Z" fill="#DA291C"/>\n            <path d="M15.4594 7.85645L10.0459 19.6243H11.5393L16.9937 7.85645H15.4594Z" fill="#DA291C"/>\n        </g>\n        <defs>\n            <clipPath id="clip0_9590_870">\n                <rect width="15.2982" height="11.7678" fill="white" transform="translate(10.0459 7.85645)"/>\n            </clipPath>\n        </defs>\n        ',u.append(f);var w=document.createElement("div");w.classList.add("close-button-container");var L=document.createElement("span");L.classList.add("close-button"),L.innerHTML="&times;",L.addEventListener("click",(function(){g.innerHTML="",p.style.display="none",i.style.display="flex",d.style.display="none"})),w.appendChild(u),w.appendChild(L),h.appendChild(w),h.appendChild(v),p.appendChild(h),p.appendChild(d);var g=document.createElement("div");g.classList.add("chat-messages"),g.style.display="none";var C=document.createElement("h2");C.textContent=" Welcome to Arist Assistant",C.style.textAlign="center",g.appendChild(C),p.appendChild(g);var y=document.createElement("div");y.classList.add("input-container");var b=document.createElement("input");b.classList.add("input-area"),b.setAttribute("type","text"),b.setAttribute("placeholder","Please type your question"),b.disabled=!0,y.appendChild(b);var E=document.createElement("button");function H(){var e=b.value.trim();""!==e&&(A("You",e),function(e){const t=`https://copilotfunctiondev.azurewebsites.net/api/doccopilot?code=ShtBz6XGyQvaDOfjZsautneQBfwoDPUs0ri7V5lJ36HwAzFu033W-w%3D%3D&task=genrateResponse&query=${encodeURIComponent(e)}`;fetch(t).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{e.message?(A("Bot",e.message),e.filepath&&e.filepath.forEach((function(e){A("Reference",e,!0)}))):A("Bot","Sorry, I did not understand that.")})).catch((e=>{console.error("Error:",e),A("Bot","An error occurred while processing your request.")}))}(e),b.value="",g.scrollTop=g.scrollHeight)}function A(e,t,n=!1){var a=document.createElement("div");if(a.classList.add("message"),n){var i=document.createElement("button");i.textContent=t,i.classList.add("file-button"),i.addEventListener("click",(function(){const e=`https://copilotfunctiondev.azurewebsites.net/api/doccopilot?code=ShtBz6XGyQvaDOfjZsautneQBfwoDPUs0ri7V5lJ36HwAzFu033W-w%3D%3D&task=getfile&file_name=${encodeURIComponent(t)}`;showLoadingScreen(!0),fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.blob()})).then((e=>{showLoadingScreen(!1);const n=t.split(".").pop().toLowerCase(),a=URL.createObjectURL(e);["pdf","html"].includes(n)?showModal(`<iframe src="${a}" style="width: 100%; height: 80vh;"></iframe>`):"docx"===n?convertDocxToHtml(e).then((e=>showModal(e))):"md"===n?convertMarkdownToHtml(e).then((e=>showModal(e))):alert("Unsupported file format.")})).catch((e=>{showLoadingScreen(!1),console.error("Error:",e),A("Bot","An error occurred while fetching the file.")}))})),a.appendChild(i)}else"You"===e?(e='\n                            <svg xmlns="http://www.w3.org/2000/svg" class="user-Icon" width="27"  height="27" viewBox="0 0 27 27" fill="none">\n                                <circle cx="13.5" cy="13.5" r="13.5" fill="black"/>\n                                <path d="M17.5762 9.228V10.81H13.5022V13.316H16.6242V14.87H13.5022V19H11.5422V9.228H17.5762Z" fill="white"/>\n                            </svg>',a.classList.add("user")):(e='\n                            <svg xmlns="http://www.w3.org/2000/svg" class="bot-Icon" width="27" height="27" viewBox="0 0 27 27" fill="none">\n                    <circle cx="13.5" cy="13.5" r="13.5" fill="#DA291C"/>\n                    <path d="M15.8853 8L21.2982 19.7678H19.8054L14.3503 8H15.8853Z" fill="#FFFEFE"/>\n                    <path d="M12.9498 8L18.3626 19.7678H16.8692L11.4148 8H12.9498Z" fill="#FFFEFE"/>\n                    <path d="M11.4135 8L6 19.7678H7.49337L12.9478 8H11.4135Z" fill="#FFFEFE"/>\n                    </svg>',a.classList.add("arist-Bot")),a.innerHTML=`<strong>${e}</strong> ${t}`;document.querySelector(".chat-messages").appendChild(a)}E.classList.add("send-button"),E.innerHTML="&#x27A4;",E.disabled=!0,E.addEventListener("click",(function(){H()})),b.addEventListener("keydown",(function(e){"Enter"===e.key&&H()})),y.appendChild(E),p.appendChild(y),e.appendChild(p),document.body.appendChild(e),i.addEventListener("click",(function(){p.style.display="block",n()===a()?d.style.display="none":d.style.display="flex",i.style.display="none"})),c.addEventListener("click",(function(){var e=o.value.trim();e===a()?(t(e),d.style.display="none",b.disabled=!1,E.disabled=!1,g.style.display="block"):r.textContent="Invalid token. Please try again."}))},setAuthToken:t,getAuthToken:n,getSubscriptionKey:a}}();document.addEventListener("DOMContentLoaded",(function(){e.createChatBotUI()}))})();